<UserControl x:Class="MyCompany.WPF.TestHarness.Views.LogsView"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:controls="clr-namespace:MyCompany.WPF.TestHarness.Controls"
xmlns:localConverters="clr-namespace:MyCompany.WPF.TestHarness.Converters"
xmlns:telerik="http://schemas.telerik.com/2008/xaml/presentation">

```
<UserControl.Resources>
    <localConverters:TextHighlightConverter x:Key="TextHighlightConverter"/>
    
    <!-- Templates avec surlignage précis du texte -->
    <DataTemplate x:Key="ErrorTemplate">
        <Grid Background="Red" Padding="5,2">
            <ContentPresenter>
                <ContentPresenter.Content>
                    <MultiBinding Converter="{StaticResource TextHighlightConverter}">
                        <Binding Path="."/>
                        <Binding Path="DataContext.FilterText" RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                        <Binding Source="White" />
                    </MultiBinding>
                </ContentPresenter.Content>
            </ContentPresenter>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="BreachedTemplate">
        <Grid Background="#C53A3A" Padding="5,2">
            <ContentPresenter>
                <ContentPresenter.Content>
                    <MultiBinding Converter="{StaticResource TextHighlightConverter}">
                        <Binding Path="."/>
                        <Binding Path="DataContext.FilterText" RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                        <Binding Source="White" />
                    </MultiBinding>
                </ContentPresenter.Content>
            </ContentPresenter>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="WarningTemplate">
        <Grid Background="#EBBF14" Padding="5,2">
            <ContentPresenter>
                <ContentPresenter.Content>
                    <MultiBinding Converter="{StaticResource TextHighlightConverter}">
                        <Binding Path="."/>
                        <Binding Path="DataContext.FilterText" RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                        <Binding Source="Black" />
                    </MultiBinding>
                </ContentPresenter.Content>
            </ContentPresenter>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="ExemptTemplate">
        <Grid Background="Yellow" Padding="5,2">
            <ContentPresenter>
                <ContentPresenter.Content>
                    <MultiBinding Converter="{StaticResource TextHighlightConverter}">
                        <Binding Path="."/>
                        <Binding Path="DataContext.FilterText" RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                        <Binding Source="Black" />
                    </MultiBinding>
                </ContentPresenter.Content>
            </ContentPresenter>
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="PassedTemplate">
        <Grid Background="#67AC53" Padding="5,2">
            <ContentPresenter>
                <ContentPresenter.Content>
                    <MultiBinding Converter="{StaticResource TextHighlightConverter}">
                        <Binding Path="."/>
                        <Binding Path="DataContext.FilterText" RelativeSource="{RelativeSource AncestorType=UserControl}"/>
                        <Binding Source="White" />
                    </MultiBinding>
                </ContentPresenter.Content>
            </ContentPresenter>
        </Grid>
    </DataTemplate>

    <!-- Sélecteur de template existant -->
    <localConverters:DealStateTemplateSelector x:Key="logTemplateSelector"
                                               ErrorTemplate="{StaticResource ErrorTemplate}"
                                               BreachedTemplate="{StaticResource BreachedTemplate}"
                                               WarningTemplate="{StaticResource WarningTemplate}"
                                               ExemptTemplate="{StaticResource ExemptTemplate}"
                                               PassedTemplate="{StaticResource PassedTemplate}"/>
</UserControl.Resources>

<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Zone de texte pour filtrer avec placeholder -->
    <Grid Grid.Row="0" Margin="5">
        <TextBox x:Name="FilterBox"
                 Text="{Binding FilterText, UpdateSourceTrigger=PropertyChanged}"
                 Height="25"
                 Padding="5,0"
                 BorderBrush="Gray"
                 BorderThickness="1"/>
        <TextBlock Text="Filtrer les logs..." 
                   Foreground="Gray" 
                   IsHitTestVisible="False"
                   Margin="8,0,0,0"
                   VerticalAlignment="Center"
                   FontStyle="Italic">
            <TextBlock.Style>
                <Style TargetType="TextBlock">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Text, ElementName=FilterBox}" Value="">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                    <Setter Property="Visibility" Value="Hidden"/>
                </Style>
            </TextBlock.Style>
        </TextBlock>
    </Grid>

    <!-- Checkbox pour activer/désactiver le filtrage -->
    <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="5,0,5,5">
        <CheckBox x:Name="FilterEnabledCheckBox" 
                  IsChecked="{Binding IsFilterEnabled}"
                  VerticalAlignment="Center"
                  Margin="0,0,5,0"/>
        <TextBlock Text="Filtrer les logs (masquer les non-correspondants)" 
                   VerticalAlignment="Center"
                   Foreground="DarkGray"
                   FontSize="12"/>
    </StackPanel>

    <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
        <controls:LoggingListView x:Name="logsListBox"
                                ItemsSource="{Binding Logs}"
                                ItemTemplateSelector="{StaticResource logTemplateSelector}"
                                SelectionMode="Extended"
                                Background="#3C5C5C">
            
            <controls:LoggingListView.ItemContainerStyle>
                <Style TargetType="ListViewItem">
                    <Setter Property="Foreground" Value="Blue"/>
                </Style>
            </controls:LoggingListView.ItemContainerStyle>
        </controls:LoggingListView>
    </ScrollViewer>
</Grid>
```

</UserControl>